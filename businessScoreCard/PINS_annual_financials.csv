name,ttm,12/31/2021,12/31/2020,12/31/2019,12/31/2018,12/31/2017
TotalRevenue,"2,667,682,000","2,578,027,000","1,692,658,000","1,142,761,000","755,932,000","472,852,000"
	OperatingRevenue,"2,667,682,000","2,578,027,000","1,692,658,000","1,142,761,000","755,932,000","472,852,000"
CostOfRevenue,"541,920,000","529,320,000","449,358,000","358,903,000","241,584,000","178,664,000"
GrossProfit,"2,125,762,000","2,048,707,000","1,243,300,000","783,858,000","514,348,000","294,188,000"
OperatingExpense,"1,780,332,000","1,722,520,000","1,385,804,000","2,172,724,000","589,069,000","432,122,000"
	SellingGeneralAndAdministration,"976,248,000","942,256,000","779,610,000","965,665,000","337,407,000","224,149,000"
		GeneralAndAdministrativeExpense,"291,338,000","300,977,000","336,803,000","354,075,000","77,478,000","61,635,000"
			OtherGandA,"291,338,000","300,977,000","336,803,000","354,075,000","77,478,000","61,635,000"
		SellingAndMarketingExpense,"684,910,000","641,279,000","442,807,000","611,590,000","259,929,000","162,514,000"
	ResearchAndDevelopment,"804,084,000","780,264,000","606,194,000","1,207,059,000","251,662,000","207,973,000"
OperatingIncome,"345,430,000","326,187,000","-142,504,000","-1,388,866,000","-74,721,000","-137,934,000"
NetNonOperatingInterestIncomeExpense,"-5,633,000","-5,216,000","15,484,000","28,027,000","12,157,000","8,201,000"
	InterestIncomeNonOperating,"3,800,000","4,204,000","16,119,000","30,164,000","13,152,000","8,313,000"
	InterestExpenseNonOperating,"9,433,000","9,420,000","635,000","2,137,000","995,000","112,000"
PretaxIncome,"339,797,000","320,971,000","-127,020,000","-1,360,839,000","-62,564,000","-129,733,000"
TaxProvision,"6,966,000","4,533,000","1,303,000","532,000","410,000","311,000"
NetIncomeCommonStockholders,"332,831,000","316,438,000","-128,323,000","-1,361,371,000","-62,974,000","-130,044,000"
	NetIncome,"332,831,000","316,438,000","-128,323,000","-1,361,371,000","-62,974,000","-130,044,000"
		NetIncomeIncludingNoncontrollingInterests,"332,831,000","316,438,000","-128,323,000","-1,361,371,000","-62,974,000","-130,044,000"
			NetIncomeContinuousOperations,"332,831,000","316,438,000","-128,323,000","-1,361,371,000","-62,974,000","-130,044,000"
	OtherunderPreferredStockDividend,,,,0,,
DilutedNIAvailtoComStockholders,"332,831,000","316,438,000","-128,323,000","-1,361,371,000","-62,974,000","-130,044,000"
BasicEPS,,0.49,-0.22,-3.24,-0.14,-0.29
DilutedEPS,,0.46,-0.22,-3.24,-0.14,-0.29
BasicAverageShares,,"640,030,000","596,264,000","420,473,000","448,639,000","448,639,000"
DilutedAverageShares,,"691,651,000","596,264,000","420,473,000","448,639,000","448,639,000"
TotalOperatingIncomeAsReported,"345,430,000","326,187,000","-142,504,000","-1,388,866,000","-74,721,000","-137,934,000"
TotalExpenses,"2,322,252,000","2,251,840,000","1,835,162,000","2,531,627,000","830,653,000","610,786,000"
NetIncomeFromContinuingAndDiscontinuedOperation,"332,831,000","316,438,000","-128,323,000","-1,361,371,000","-62,974,000","-130,044,000"
NormalizedIncome,"332,831,000","316,438,000","-128,323,000","-1,361,371,000","-62,974,000","-130,044,000"
InterestIncome,"3,800,000","4,204,000","16,119,000","30,164,000","13,152,000","8,313,000"
InterestExpense,"9,433,000","9,420,000","635,000","2,137,000","995,000","112,000"
NetInterestIncome,"-5,633,000","-5,216,000","15,484,000","28,027,000","12,157,000","8,201,000"
EBIT,"349,230,000","330,391,000","-126,385,000","-1,358,702,000","-61,569,000","-129,621,000"
EBITDA,"377,167,000",,,,,
ReconciledCostOfRevenue,"541,920,000","529,320,000","449,358,000","358,903,000","241,584,000","178,664,000"
ReconciledDepreciation,"27,937,000","27,500,000","36,988,000","27,791,000","20,859,000","16,135,000"
NetIncomeFromContinuingOperationNetMinorityInterest,"332,831,000","316,438,000","-128,323,000","-1,361,371,000","-62,974,000","-130,044,000"
NormalizedEBITDA,"377,167,000","357,891,000","-89,397,000","-1,330,911,000","-40,710,000","-113,486,000"
TaxRateForCalcs,0.021,0.014,0.27,0.27,0.27,0.4
TaxEffectOfUnusualItems,0,0,0,0,0,0